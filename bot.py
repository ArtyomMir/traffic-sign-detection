import os
import tempfile
from telegram import Update
from telegram.ext import ApplicationBuilder, MessageHandler, ContextTypes, filters, CommandHandler
from ultralytics import YOLO
sign_dict = {
    "2_1": "–ì–ª–∞–≤–Ω–∞—è –¥–æ—Ä–æ–≥–∞",
    "1_23": "–î–µ—Ç–∏",
    "1_17": "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–µ—Ä–æ–≤–Ω–æ—Å—Ç—å",
    "3_24_n40": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ 40 –∫–º/—á",
    "8_2_1": "–ó–æ–Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è",
    "5_20": "–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –Ω–µ—Ä–æ–≤–Ω–æ—Å—Ç—å",
    "3_24_n20": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ 20 –∫–º/—á",
    "5_19_1": "–ü–µ—à–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥",
    "5_16": "–ú–µ—Å—Ç–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞–≤—Ç–æ–±—É—Å–∞ –∏ (–∏–ª–∏) —Ç—Ä–æ–ª–ª–µ–π–±—É—Å–∞",
    "3_25_n20": "–ö–æ–Ω–µ—Ü –∑–æ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ 20 –∫–º/—á",
    "6_16": "–°—Ç–æ–ø-–ª–∏–Ω–∏—è",
    "7_15": "–ó–æ–Ω–∞ –ø—Ä–∏—ë–º–∞ —Ä–∞–¥–∏–æ—Å—Ç–∞–Ω—Ü–∏–∏, –ø–µ—Ä–µ–¥–∞—é—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Ä–æ–∂–Ω–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏",
    "2_2": "–ö–æ–Ω–µ—Ü –≥–ª–∞–≤–Ω–æ–π –¥–æ—Ä–æ–≥–∏",
    "2_4": "–£—Å—Ç—É–ø–∏—Ç–µ –¥–æ—Ä–æ–≥—É",
    "8_13_1": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π –¥–æ—Ä–æ–≥–∏",
    "4_2_1": "–û–±—ä–µ–∑–¥ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —Å–ø—Ä–∞–≤–∞",
    "1_20_3": "–°—É–∂–µ–Ω–∏–µ –¥–æ—Ä–æ–≥–∏ —Å–ª–µ–≤–∞",
    "1_25": "–î–æ—Ä–æ–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã",
    "3_4_n8": "–î–≤–∏–∂–µ–Ω–∏–µ –≥—Ä—É–∑–æ–≤—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –∑–∞–ø—Ä–µ—â–µ–Ω–æ",
    "8_3_2": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è",
    "3_4_1": "–î–≤–∏–∂–µ–Ω–∏–µ –≥—Ä—É–∑–æ–≤—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –∑–∞–ø—Ä–µ—â–µ–Ω–æ",
    "4_1_6": "–î–≤–∏–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–æ –∏–ª–∏ –Ω–∞–ª–µ–≤–æ",
    "4_2_3": "–û–±—ä–µ–∑–¥ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —Å–ª–µ–≤–∞ –∏ —Å–ø—Ä–∞–≤–∞",
    "4_1_1": "–î–≤–∏–∂–µ–Ω–∏–µ –ø—Ä—è–º–æ",
    "1_33": "–ü—Ä–æ—á–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
    "5_15_5": "–ö–æ–Ω–µ—Ü –ø–æ–ª–æ—Å—ã",
    "3_27": "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–∞",
    "1_15": "–°–∫–æ–ª—å–∑–∫–∞—è –¥–æ—Ä–æ–≥–∞",
    "4_1_2_1": "–î–≤–∏–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–æ",
    "6_3_1": "–ú–µ—Å—Ç–æ –¥–ª—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞",
    "8_1_1": "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –æ–±—ä–µ–∫—Ç–∞ ",
    "6_7": "–ù–∞–¥–∑–µ–º–Ω—ã–π –ø–µ—à–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥",
    "5_15_3": "–ù–∞—á–∞–ª–æ –ø–æ–ª–æ—Å—ã",
    "7_3": "–ê–≤—Ç–æ–∑–∞–ø—Ä–∞–≤–æ—á–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è",
    "1_19": "–û–ø–∞—Å–Ω–∞—è –æ–±–æ—á–∏–Ω–∞",
    "6_4": "–ü–∞—Ä–∫–æ–≤–∫–∞ ",
    "8_1_4": "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –æ–±—ä–µ–∫—Ç–∞",
    "8_8": "–ü–ª–∞—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏",
    "1_16": "–ù–µ—Ä–æ–≤–Ω–∞—è –¥–æ—Ä–æ–≥–∞",
    "1_11_1": "–û–ø–∞—Å–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç –ø—Ä–∞–≤—ã–π",
    "6_6": "–ü–æ–¥–∑–µ–º–Ω—ã–π –ø–µ—à–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥",
    "5_15_1": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –ø–æ–ª–æ—Å–∞–º",
    "7_2": "–ë–æ–ª—å–Ω–∏—Ü–∞",
    "5_15_2": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –ø–æ–ª–æ—Å–∞–º",
    "7_12": "–ü–æ—Å—Ç –¥–æ—Ä–æ–∂–Ω–æ-–ø–∞—Ç—Ä—É–ª—å–Ω–æ–π —Å–ª—É–∂–±—ã",
    "3_18": "–ü–æ–≤–æ—Ä–æ—Ç –∑–∞–ø—Ä–µ—â—ë–Ω",
    "5_6": "–ö–æ–Ω–µ—Ü –¥–æ—Ä–æ–≥–∏ —Å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –¥–≤–∏–∂–µ–Ω–∏–µ–º",
    "5_5": "–î–æ—Ä–æ–≥–∞ —Å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –¥–≤–∏–∂–µ–Ω–∏–µ–º",
    "7_4": "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π",
    "4_1_2": "–î–≤–∏–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–æ",
    "8_2_2": "–ó–æ–Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø—Ä–µ—â–∞—é—â–∏—Ö –∑–Ω–∞–∫–æ–≤",
    "7_11": "–ú–µ—Å—Ç–æ –æ—Ç–¥—ã—Ö–∞",
    "3_24_n5": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ 5 –∫–º/—á",
    "1_22": "–ü–µ—à–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥",
    "1_27": "–î–∏–∫–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ",
    "2_3_2": "–ü—Ä–∏–º—ã–∫–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –¥–æ—Ä–æ–≥–∏ —Å–ø—Ä–∞–≤–∞",
    "5_15_2_2": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –ø–æ–ª–æ—Å–µ",
    "1_8": "–°–≤–µ—Ç–æ—Ñ–æ—Ä–Ω–æ–µ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "3_13_r5": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã",
    "2_3": "–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å–æ –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –¥–æ—Ä–æ–≥–æ–π",
    "8_3_3": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–µ–≤–æ –∏ –ø—Ä–∞–≤–æ",
    "2_3_3": "–ü—Ä–∏–º—ã–∫–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –¥–æ—Ä–æ–≥–∏ —Å–ª–µ–≤–∞",
    "7_7": "–ü—É–Ω–∫—Ç –ø–∏—Ç–∞–Ω–∏—è",
    "1_11": "–û–ø–∞—Å–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç",
    "8_13": "–§–æ—Ç–æ–≤–∏–¥–µ–æ—Ñ–∏–∫—Å–∞—Ü–∏—è",
    "3_24_n30": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ 30 –∫–º/—á",
    "1_12_2": "–û–ø–∞—Å–Ω—ã–µ –ø–æ–≤–æ—Ä–æ—Ç—ã (—Å –ø–µ—Ä–≤—ã–º –ø–æ–≤–æ—Ä–æ—Ç–æ–º –Ω–∞–ª–µ–≤–æ)",
    "1_20": "–°–≤–µ—Ç–æ—Ñ–æ—Ä–Ω–æ–µ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "1_12": "–û–ø–∞—Å–Ω—ã–µ –ø–æ–≤–æ—Ä–æ—Ç—ã",
    "3_24_n60": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ 60 –∫–º/—á",
    "3_24_n70": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ 70 –∫–º/—á",
    "3_24_n50": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ 50 –∫–º/—á",
    "3_32": "–ù–∞—á–∞–ª–æ –Ω–∞—Å–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞",
    "2_5": "–î–≤–∏–∂–µ–Ω–∏–µ –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–æ",
    "3_1": "–í—ä–µ–∑–¥ –∑–∞–ø—Ä–µ—â—ë–Ω",
    "4_8_2": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ —Å –æ–ø–∞—Å–Ω—ã–º–∏ –≥—Ä—É–∑–∞–º–∏ –Ω–∞–ø—Ä–∞–≤–æ",
    "3_20": "–û–±–≥–æ–Ω –∑–∞–ø—Ä–µ—â—ë–Ω",
    "3_13_r4.5": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã",
    "3_2": "–î–≤–∏–∂–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ",
    "2_3_6": "–ü—Ä–∏–º—ã–∫–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –¥–æ—Ä–æ–≥–∏ —Å–ø—Ä–∞–≤–∞ –ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏",
    "5_22": "–ö–æ–Ω–µ—Ü –∂–∏–ª–æ–π –∑–æ–Ω—ã",
    "5_18": "–ú–µ—Å—Ç–æ —Å—Ç–æ—è–Ω–∫–∏ –ª–µ–≥–∫–æ–≤—ã—Ö —Ç–∞–∫—Å–∏",
    "2_3_5": "–ü—Ä–∏–º—ã–∫–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –¥–æ—Ä–æ–≥–∏ —Å–ª–µ–≤–∞ –ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏",
    "7_5": "–ú–æ–π–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π",
    "8_4_1": "–í–∏–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ì—Ä—É–∑–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å –ø—Ä–∏—Ü–µ–ø–æ–º, —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –º–∞—Å—Å–æ–π –±–æ–ª–µ–µ 3,5 —Ç.",
    "3_13_r3.7": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 3.7",
    "3_14_r3.7": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã 3.7",
    "1_2": "–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π –ø–µ—Ä–µ–µ–∑–¥ –±–µ–∑ —à–ª–∞–≥–±–∞—É–º–∞",
    "1_20_2": "–°—É–∂–µ–Ω–∏–µ –¥–æ—Ä–æ–≥–∏ —Å–ø—Ä–∞–≤–∞",
    "4_1_4": "–î–≤–∏–∂–µ–Ω–∏–µ –ø—Ä—è–º–æ –∏ –Ω–∞–ø—Ä–∞–≤–æ",
    "7_6": "–¢–µ–ª–µ—Ñ–æ–Ω",
    "8_1_3": "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –æ–±—ä–µ–∫—Ç–∞",
    "8_3_1": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–ø—Ä–∞–≤–∞",
    "4_3": "–ö—Ä—É–≥–æ–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ",
    "4_1_5": "–î–≤–∏–∂–µ–Ω–∏–µ –ø—Ä—è–º–æ –∏ –Ω–∞–ª–µ–≤–æ",
    "8_2_3": "–ö–æ–Ω–µ—Ü –∑–æ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—è",
    "8_2_4": "–í –∑–æ–Ω–µ –¥–µ–π—Å—Ç–≤–∏—è",
    "3_24_n80": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ 80 –∫–º/—á",
    "1_31": "–¢–æ–Ω–Ω–µ–ª—å",
    "3_10": "–î–≤–∏–∂–µ–Ω–∏–µ –ø–µ—à–µ—Ö–æ–¥–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ",
    "4_2_2": "–û–±—ä–µ–∑–¥ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —Å–ª–µ–≤–∞",
    "3_13_r2.5": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã",
    "7_1": "–ü—É–Ω–∫—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø–æ–º–æ—â–∏",
    "3_28": "–°—Ç–æ—è–Ω–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–∞",
    "4_1_3": "–î–≤–∏–∂–µ–Ω–∏–µ –Ω–∞–ª–µ–≤–æ",
    "5_4": "–ö–æ–Ω–µ—Ü –¥–æ—Ä–æ–≥–∏ –¥–ª—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π",
    "5_3": "–î–æ—Ä–æ–≥–∞ –¥–ª—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π",
    "3_25_n40": "–ö–æ–Ω–µ—Ü –∑–æ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ 40 –∫–º/—á",
    "3_13_r4": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã",
    "6_8_2": "–õ–µ—Å—Ç–Ω–∏—á–Ω—ã–π —Å–ø—É—Å–∫ (—ç–≤–∞–∫—É–∞—Ü–∏—è)",
    "3_31": "–ö–æ–Ω–µ—Ü –∑–æ–Ω—ã –≤—Å–µ—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π",
    "6_2_n50": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å - 50 –∫–º/—á",
    "3_24_n10": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ 10 –∫–º/—á",
    "3_25_n50": "–ö–æ–Ω–µ—Ü –∑–æ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ 50 –∫–º/—á",
    "1_21": "–î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ –¥–≤–∏–∂–µ–Ω–∏–µ",
    "3_21": "–ö–æ–Ω–µ—Ü –∑–æ–Ω—ã –∑–∞–ø—Ä–µ—â–µ–Ω–∏—è –æ–±–≥–æ–Ω–∞",
    "1_13": "–ö—Ä—É—Ç–æ–π —Å–ø—É—Å–∫",
    "1_14": "–ö—Ä—É—Ç–æ–π –ø–æ–¥—ä–µ–º",
    "6_2_n70": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å - 70 –∫–º/—á",
    "2_3_4": "–ü—Ä–∏–º—ã–∫–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–π –¥–æ—Ä–æ–≥–∏ —Å–ø—Ä–∞–≤–∞ –ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏",
    "4_8_3": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ —Å –æ–ø–∞—Å–Ω—ã–º–∏ –≥—Ä—É–∑–∞–º–∏ –Ω–∞–ª–µ–≤–æ",
    "6_15_2": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –≥—Ä—É–∑–æ–≤—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π",
    "2_6": "–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –≤—Å—Ç—Ä–µ—á–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è",
    "3_18_2": "–ü–æ–≤–æ—Ä–æ—Ç –Ω–∞–ª–µ–≤–æ –∑–∞–ø—Ä–µ—â–µ–Ω",
    "4_1_2_2": "–î–≤–∏–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–æ",
    "1_7": "–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å –∫—Ä—É–≥–æ–≤—ã–º –¥–≤–∏–∂–µ–Ω–∏–µ–º",
    "3_19": "–†–∞–∑–≤–æ—Ä–æ—Ç –∑–∞–ø—Ä–µ—â–µ–Ω",
    "1_18": "–í—ã–±—Ä–æ—Å –≥—Ä–∞–≤–∏—è",
    "2_7": "–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–¥ –≤—Å—Ç—Ä–µ—á–Ω—ã–º –¥–≤–∏–∂–µ–Ω–∏–µ–º",
    "8_5_4": "–í—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è",
    "3_25_n80": "–ö–æ–Ω–µ—Ü –∑–æ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ 80 –∫–º/—á",
    "5_15_7": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –ø–æ–ª–æ—Å–∞–º",
    "5_14": "–ü–æ–ª–æ—Å–∞ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤",
    "5_21": "–ñ–∏–ª–∞—è –∑–æ–Ω–∞",
    "1_1": "–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π –ø–µ—Ä–µ–µ–∑–¥ —Å–æ —à–ª–∞–≥–±–∞—É–º–æ–º",
    "6_15_1": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –≥—Ä—É–∑–æ–≤—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π",
    "3_4_n2": "–î–≤–∏–∂–µ–Ω–∏–µ –≥—Ä—É–∑–æ–≤—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –∑–∞–ø—Ä–µ—â–µ–Ω–æ",
    "8_6_4": "–°–ø–æ—Å–æ–± –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ —Å—Ç–æ—è–Ω–∫—É",
    "8_15": "–°–ª–µ–ø—ã–µ –ø–µ—à–µ—Ö–æ–¥—ã",
    "4_5": "–ü–µ—à–µ—Ö–æ–¥–Ω–∞—è –¥–æ—Ä–æ–∂–∫–∞",
    "3_13_r4.2": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 4.2",
    "6_2_n60": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å 60 –∫–º/—á",
    "3_11_n23": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã",
    "3_11_n9": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã",
    "8_18": "–ö—Ä–æ–º–µ –∏–Ω–≤–∞–ª–∏–¥–æ–≤",
    "8_4_4": "–í–∏–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ú–∞—Ä—à—Ä—É—Ç–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞",
    "3_30": "–°—Ç–æ—è–Ω–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –ø–æ —á–µ—Ç–Ω—ã–º —á–∏—Å–ª–∞–º –º–µ—Å—è—Ü–∞",
    "5_7_1": "–í—ã–µ–∑–¥ –Ω–∞ –¥–æ—Ä–æ–≥—É —Å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –¥–≤–∏–∂–µ–Ω–∏–µ–º ",
    "5_7_2": "–í—ã–µ–∑–¥ –Ω–∞ –¥–æ—Ä–æ–≥—É —Å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –¥–≤–∏–∂–µ–Ω–∏–µ–º",
    "1_5": "–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å —Ç—Ä–∞–º–≤–∞–π–Ω–æ–π –ª–∏–Ω–∏–µ–π",
    "3_29": "–°—Ç–æ—è–Ω–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –ø–æ –Ω–µ—á–µ—Ç–Ω—ã–º —á–∏—Å–ª–∞–º –º–µ—Å—è—Ü–∞",
    "6_15_3": "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –≥—Ä—É–∑–æ–≤—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π",
    "5_12": "–ö–æ–Ω–µ—Ü –¥–æ—Ä–æ–≥–∏ —Å –ø–æ–ª–æ—Å–æ–π –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤",
    "3_16_n3": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏",
    "3_13_r4.3": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 4.3",
    "1_30": "–ù–∏–∑–∫–æ–ª–µ—Ç—è—â–∏–µ —Å–∞–º–æ–ª–µ—Ç—ã",
    "5_11": "–î–æ—Ä–æ–≥–∞ —Å –ø–æ–ª–æ—Å–æ–π –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤",
    "1_6": "–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω—ã—Ö –¥–æ—Ä–æ–≥",
    "8_6_2": "–°–ø–æ—Å–æ–± –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ —Å—Ç–æ—è–Ω–∫—É",
    "6_8_3": "–¢—É–ø–∏–∫",
    "3_12_n10": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã, –ø—Ä–∏—Ö–æ–¥—è—â–µ–π—Å—è –Ω–∞ –æ—Å—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞",
    "3_12_n6": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã, –ø—Ä–∏—Ö–æ–¥—è—â–µ–π—Å—è –Ω–∞ –æ—Å—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞",
    "3_33": "–ó–æ–Ω–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ –¢–°",
    "3_11_n13": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã",
    "3_14_r2.7": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã",
    "3_16_n1": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ 10 –º",
    "8_4_3": "–í–∏–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ –õ–µ–≥–∫–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏, –ì—Ä—É–∑–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –º–∞—Å—Å–æ–π –¥–æ 3,5 —Ç.",
    "5_8": "–†–µ–≤–µ—Ä—Å–∏–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ",
    "3_11_n20": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã",
    "3_11_n5": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã",
    "8_14": "–ü–æ–ª–æ—Å–∞ –¥–≤–∏–∂–µ–Ω–∏—è",
    "3_11_n8": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã 8 —Ç",
    "3_4_n5": "–î–≤–∏–∂–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –¢–° –º–∞—Å—Å–æ–π –±–æ–ª–µ–µ 5 —Ç",
    "8_17": "–ò–Ω–≤–∞–ª–∏–¥—ã",
    "3_6": "–î–≤–∏–∂–µ–Ω–∏–µ —Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ –∑–∞–ø—Ä–µ—â–µ–Ω–æ",
    "3_14_r3": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã",
    "1_26": "–ü–µ—Ä–µ–≥–æ–Ω —Å–∫–æ—Ç–∞",
    "3_12_n5": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã, –ø—Ä–∏—Ö–æ–¥—è—â–µ–π—Å—è –Ω–∞ –æ—Å—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞",
    "8_5_2": "–†–∞–±–æ—á–∏–µ –¥–Ω–∏",
    "6_8_1": "–¢—É–ø–∏–∫",
    "5_17": "–ú–µ—Å—Ç–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç—Ä–∞–º–≤–∞—è",
    "1_10": "–í—ã–µ–∑–¥ –Ω–∞ –Ω–∞–±–µ—Ä–µ–∂–Ω—É—é",
    "3_13_r3.5": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 3.5",
    "3_13_r3.3": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 3.3",
    "3_13_r4.1": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 4.1",
    "3_11_n17": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã",
    "8_16": "–í–ª–∞–∂–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ",
    "3_13_r3": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 3",
    "3_25_n70": "–ö–æ–Ω–µ—Ü –∑–æ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ 70 –∫–º/—á",
    "6_2_n20": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å - 20 –∫–º/—á",
    "3_12_n3": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å—ã, –ø—Ä–∏—Ö–æ–¥—è—â–µ–π—Å—è –Ω–∞ –æ—Å—å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞",
    "3_14_r3.5": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã 3.5",
    "3_13_r3.9": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 3.9",
    "6_2_n40": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å - 40 –∫–º/—á",
    "3_13_r5.2": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã 5.2",
    "7_18": "–¢—É–∞–ª–µ—Ç",
    "7_14": "–ü—É–Ω–∫—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è",
    "8_23": "–§–æ—Ç–æ–≤–∏–¥–µ–æ—Ñ–∏–∫—Å–∞—Ü–∏—è",
}
sign_names = list(sign_dict.values())
# === –ó–∞–≥—Ä—É–∂–∞–µ–º YOLO –º–æ–¥–µ–ª—å ===
model = YOLO("Diplom2.pt")

# === –°—Ç–∞—Ä—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ ===
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞ –≤–æ –≤—Ä–µ–º—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–º —Å—Ä–µ–¥—Å—Ç–≤–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω–æ.\n"
        "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —Ç–æ–ª—å–∫–æ –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º –ø–æ –ü–î–î.\n\n"
        "üì∑ –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ ‚Äî –∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –µ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è."
    )

# === –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ç–æ ===
async def handle_photo(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        await update.message.reply_text("üì∑ –§–æ—Ç–æ –ø–æ–ª—É—á–µ–Ω–æ, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é...")

        photo = update.message.photo[-1]
        photo_file = await photo.get_file()

        with tempfile.NamedTemporaryFile(suffix=".jpg", delete=False) as tmp:
            tmp_path = tmp.name

        await photo_file.download_to_drive(tmp_path)

        results = model(tmp_path, conf=0.30)
        pred_path = tmp_path.replace(".jpg", "_pred.jpg")
        results[0].save(filename=pred_path)
        class_ids = results[0].boxes.cls.long().cpu().tolist()

        if class_ids:
            text = "üö¶ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∑–Ω–∞–∫–∏:\n"
            for i in class_ids:
                if i < len(sign_names):
                    text += f"‚Ä¢ {sign_names[i]}\n"
                else:
                    text += "‚Ä¢ –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫\n"
            await update.message.reply_text(text)

            # –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤
            with open(pred_path, "rb") as img:
                await update.message.reply_photo(img)

        else:
            await update.message.reply_text(
                "‚ö†Ô∏è –ó–Ω–∞–∫–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω—ã.\n"
                "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–Ω–∞–∫ —á—ë—Ç–∫–æ –≤–∏–¥–µ–Ω, "
                "–Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–µ —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ –∫ –∫–∞–º–µ—Ä–µ –∏ —Ö–æ—Ä–æ—à–æ –æ—Å–≤–µ—â—ë–Ω."
            )

    except Exception as e:
        await update.message.reply_text(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        print("‚ùå –û—à–∏–±–∫–∞:", e)

    finally:
        for path in [tmp_path, pred_path]:
            try:
                if os.path.exists(path):
                    os.remove(path)
            except:
                pass

# === –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ===
app = ApplicationBuilder().token("111111111:AAEdfgdfgdjk5dhN24Nz6clYKzk").build()
app.add_handler(MessageHandler(filters.PHOTO, handle_photo))
app.add_handler(CommandHandler("start", start))
app.run_polling()
